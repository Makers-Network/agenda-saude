<%= render :layout => '/ubs/nav' do %>
  <div class="row">
    <div class="col-12">
      <%= form_with url: find_patients_path, method: :post, local: true do |f| %>
        <div class="input-group input-group-lg">
            <%= f.text_field :cpf, autofocus: true, minlength: 11, maxlength: 11, class: "form-control", placeholder: 'CPF' %>
            <div class="input-group-prepend">
              <span class="input-group-text" id="">OU</span>
            </div>
            <%= f.text_field :name, autofocus: true, autocomplete: "name", class: "form-control", placeholder: 'Nome' %>
          <!-- <div class="row">
               <div class="col-4">
               </div>
               <div class="col-4 text-center">
               <small>OU</small>
               </div>
               <div class="col-4">
               </div>
               </div> -->

            <div class="input-group-append">

              <%= f.submit "Buscar", class: "btn btn-outline-secondary" %>
            </div>
        </div>
      <% end %>
    </div>
  </div>

  <table class="table table-hover">
    <thead>
      <tr>
        <th scope="col">Data e Hora</th>
        <th scope="col">Nome</th>
        <th scope="col">CPF</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <% if @appointments_patients.present? %>
        <% @appointments_patients.each do |appointment| %>
          <tr>
            <th scope="row"><%= appointment[:start].strftime("%d/%m/%Y -- %H:%M") %></th>
            <td><%= appointment[:name] %></td>
            <td><%= appointment[:cpf] %></td>
            <!-- TODO: Link for patient details view -->
            <% if appointment[:time_delta] < 30.minutes %>
              <td><a class="btn btn-success" href=<%= '#' %>
                  >Check-In</a></td>
            <% else %>
              <td><a class="btn btn-secondary" disabled href=<%= '#' %>
                  >Check-In</a></td>
            <% end %>
          </tr>
      </tr>
        <% end %>
      <% else %>
        Pessoa n√£o encontrada
      <% end %>
    </tbody>
  </table>
<% end %>
