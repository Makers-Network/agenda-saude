<%= render :layout => '/ubs/nav' do %>
  <div class="row">
    <div class="col-12">
      <%= form_with url: find_patients_path, method: :post, local: true do |f| %>
        <div class="input-group input-group-lg" style="margin-bottom: 3%;">
          <%= f.text_field :cpf, autofocus: true, minlength: 11, maxlength: 11, class: "form-control", placeholder: 'CPF', value: @cpf %>
          <div class="input-group-prepend">
            <span class="input-group-text" id="">OU</span>
          </div>
          <%= f.text_field :name, autofocus: true, autocomplete: "name", class: "form-control", placeholder: 'Nome', value: @name %>
          <div class="input-group-append">
            <%= f.submit "Buscar", class: "btn btn-outline-secondary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <% if @appointments_patients.present? %>
    <table class="table table-hover text-large">
      <thead>
        <tr>
          <th scope="col">Data e Hora</th>
          <th scope="col">Nome</th>
          <th scope="col">CPF</th>
          <th scope="col"></th>
        </tr>
      </thead>
      <tbody>
        <% @appointments_patients.each do |appointment| %>
          <tr>
            <th scope="row"><%= appointment[:start].strftime("%d/%m/%Y") %><br><%= appointment[:start].strftime("%Hh%M") %></th>
            <td><%= appointment[:name] %></td>
            <td><%= appointment[:cpf] %></td>
            <!-- TODO: Link for patient details view -->
            <% if appointment[:time_delta] < 30.minutes %>
              <td><a class="btn btn-success" href=<%= '#' %> >Check-In</a></td>
            <% else %>
              <td><a class="btn btn-secondary" href=<%= '#' %> >Check-In</a></td>
            <% end %>
          </tr>
        </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <div class="text-center" style="padding: 10%">
      <h3>Pessoa n√£o encontrada</h3>
    </div>
  <% end %>
<% end %>
