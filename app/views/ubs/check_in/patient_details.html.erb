<div class="row">
  <div class="col-12">
    <h1><a href="/ubs/"><%= @ubs.name %></a></h1>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <% if @ubs.active %>
      <div class="d-flex justify-content-between align-items-center alert alert-success" role="alert">
        Unidade ativada: Aceitando agendamentos.
      </div>
    <% else %>
      <div class="d-flex justify-content-between align-items-center alert alert-danger" role="alert">
        Unidade desativada: Não aceitando agendamentos.
      </div>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <div class="alert alert-info">Ao cancelar ou reativar um agendamento por favor entrar em contato com o paciente.</div>
  </div>
</div>

<div class="panel" style="border: 1px solid; border-color: black">
  <div class="row no-gutters" style="border: 1px solid; border-color: black">
    <div class="col-6 text-center">
      <a href=<%= "/ubs/#{@ubs.id}/check_in" %>>Check-In</a>
    </div>
    <div class="col-6 text-center">
      <a href=<%= "/ubs/#{@ubs.id}/check_in/check_out_patients" %>>Check-Out</a>
    </div>
  </div>
  <div class="row no-gutters" style="border: 1px solid; border-color: black">
    <div class="col-12">
      <h3> Realizar check in </h3>

      <p><%= @patient[:name] %> - <%= @patient[:cpf] %></p>
      <p>Mais de 75 anos? <%= @patient[:age] >= 75 ? 'Sim' : 'Não' %> <%= "(#{@patient[:age]}) anos" %></p>
      <p>É profisional da saúde? <%= @patient[:health_professional] ? 'Sim' : 'Não' %></p>
      <p>Comorbidades? <%= @patient[:chronic_disability] ? 'Sim' : 'Não' %></p>
      <p>Check-In? <%= @appointments&.last.check_in.present? ? 'Sim' : 'Não' %></p>
      <p>Check-Out? <%= @appointments&.last.check_out.present? ? 'Sim' : 'Não' %></p>

      <% if @appointments&.last.check_in.present? %>
        <% if @appointments&.last.check_out.present? %>
          Feito
        <% else %>
          <form action=<%= ubs_confirm_check_out_path(patient_id: @patient[:id]) %> method="post">
            <input type="hidden" name="authenticity_token" value="/flyz5zuR6luhnW3lZP8YCOLixMKHjugPoNgwD60BZEhKrbnML6PJK1FGU2alZKfPz6Yzdt/0hHF3Pz22OP+8Q==">
            <button type="submit" onclick="return confirm('Você tem certeza?')">Fazer check out</button>
          </form>
        <% end %>
      <% else %>
        <form action=<%= ubs_cancel_appointment_path(patient_id: @patient[:id]) %> method="post">
          <input type="hidden" name="authenticity_token" value="/flyz5zuR6luhnW3lZP8YCOLixMKHjugPoNgwD60BZEhKrbnML6PJK1FGU2alZKfPz6Yzdt/0hHF3Pz22OP+8Q==">
          <button type="submit" onclick="return confirm('Você tem certeza?')">Cancelar este agendamento</button>
        </form>
        <br/>
        <% if @appointments&.last.start <= 180.minutes.from_now %>
          <form action=<%= ubs_confirm_check_in_path(patient_id: @patient[:id]) %> method="post">
            <input type="hidden" name="authenticity_token" value="/flyz5zuR6luhnW3lZP8YCOLixMKHjugPoNgwD60BZEhKrbnML6PJK1FGU2alZKfPz6Yzdt/0hHF3Pz22OP+8Q==">
            <button type="submit" onclick="return confirm('Você tem certeza?')">Fazer check in</button>
          </form>
        <% else %>
          <p>não pode fazer checkin tanto tempo antes</p>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

