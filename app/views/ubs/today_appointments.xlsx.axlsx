headers = ['', 'Agenda_Inicio', 'Nome', 'CPF', 'Telefone',
           'Data_Nascimento', 'Rua', 'Numero', 'Bairro']

xlsx_package.workbook.add_worksheet do |sheet|
  sheet.add_row headers

  @appointments.each_with_index do |appointment, index|
    patient = appointment.patient
    birth_date = Date.parse patient.birth_date

    sheet.add_row [
        index,
        l(appointment.start, format: :short_date_hour),
        patient.name,
        patient.cpf,
        patient.phone,
        l(birth_date, format: :short_date_hour),
        patient.public_place,
        patient.place_number,
        patient.neighborhood
      ]
  end
end
